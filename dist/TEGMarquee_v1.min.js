/*
* TEG Marquee
*
* Fancy sliding content in any of four directions.
*
* Author: Paul B. Joiner <paulj@engageyourcause.com>
* Copyright (c) 2022 PMG: The Engage Group
* License: MIT
*
* Release:
*   Version: v1
*   Branch:  master
*   Git Tag: v1
*   Date:    20221021
*/
class TEGMarquee{constructor(e){let s=this;if(s._options={marqueeSelector:"#marquee",direction:TEGMarquee.D_UP,duration:3,delay:0,timing:"linear",mousePause:!0},s._options={...s._options,...e},s._marqueeContainer=document.querySelector(s._options.marqueeSelector),null===s._marqueeContainer)throw`TEGMarquee cannot find the marquee container with selector "${s._options.marqueeSelector}"`;s._lastRatio=0,s._marqueeObserver=new IntersectionObserver(e=>{e.forEach(e=>{0===e.intersectionRatio?TEGMarquee.stop(s):s._isRunning||TEGMarquee.start(s),s._lastRatio=e.intersectionRatio})},{thresholds:[0,1]}),s._marqueeObserver.observe(s._marqueeContainer),document.addEventListener("visibilitychange",e=>{"hidden"===document.visibilityState?TEGMarquee.stop(s):TEGMarquee.start(s)}),s._scrollObserver=new IntersectionObserver(e=>{e.forEach(t=>{let n=s._marqueeContents.filter(e=>e.id===t.target.getAttribute("data-marqueeid"))[0];if(t.isIntersecting||n.seen)if(!n.seen&&.2<=t.intersectionRatio)n.seen=!0,n.lastRatio=t.intersectionRatio;else if(n.seen&&t.intersectionRatio<n.lastRatio){if(!t.isIntersecting){if(!n.duped){let e=new TEGMElement(n.element.cloneNode(!0),s._options.direction);n.duped=!0,s._marqueeContents.push(e),s._marqueeContainer.append(e.element),s._scrollObserver.observe(e.element),s.setStart(e),s._isRunning&&(e.ontransitionend=()=>{TEGMarquee.scrollItem(s,e)},TEGMarquee.scrollItem(s,e))}s._marqueeContents=s._marqueeContents.filter(e=>e.id!==n.id),s._scrollObserver.unobserve(n.element),n.remove()}}else n.lastRatio=t.intersectionRatio})},{root:s._marqueeContainer,threshold:[0,.2]}),s._isRunning=!1,s._scrollDistance=0,s._marqueeContents=[],s._lastItem;var t=s._marqueeContainer.children;if(0===t.length)throw"TEGMarquee cannot find any scrolling items in the marquee container";for(let e=0;e<t.length;e++){var n=new TEGMElement(t[e],s._options.direction),i=s.isVertical()?n.offsetHeight:n.offsetWidth;n.seen=!0,n.lastRatio=1,s._scrollDistance=Math.max(s._scrollDistance,i),0===e?(n.style=`transition: none; ${s._options.direction}: 0`,s._lastItem=n):s.setStart(n),s.lastItem.seen=!1,s.lastItem.lastRatio=0,s._scrollObserver.observe(n.element),s._marqueeContents.push(n)}}static get D_DOWN(){return"bottom"}static get D_LEFT(){return"left"}static get D_RIGHT(){return"right"}static get D_UP(){return"top"}static get DIRECTIONS(){return[TEGMarquee.D_UP,TEGMarquee.D_RIGHT,TEGMarquee.D_DOWN,TEGMarquee.D_LEFT]}get options(){return this._options}get marqueeContainer(){return this._marqueeContainer}get marqueeContents(){return this._marqueeContents}get direction(){return this._options.direction}get duration(){return this._options.duration}get delay(){return this._options.delay}get timing(){return this._options.timing}get scrollDistance(){return this._scrollDistance}get lastItem(){return this._lastItem}set lastItem(e){this._lastItem=e}get isRunning(){return this._isRunning}set isRunning(e){this._isRunning=e}isVertical(){return this._options.direction===TEGMarquee.D_UP||this._options.direction===TEGMarquee.D_DOWN}doScroll(){let e=this;e.options.mousePause&&(e._marqueeContainer.onmouseenter=()=>{TEGMarquee.stop(e)},e._marqueeContainer.onmouseleave=()=>{TEGMarquee.start(e)}),e.marqueeContainer.style.visible&&TEGMarquee.start(e)}setStart(e){var t=this;switch(t.direction){case TEGMarquee.D_UP:e.style=`transition: none; top: ${t.lastItem.animationOffset+t.lastItem.offsetHeight}px;`;break;case TEGMarquee.D_DOWN:e.style=`transition: none; bottom: ${t.lastItem.animationOffset+t.lastItem.offsetHeight}px;`;break;case TEGMarquee.D_LEFT:e.style=`transition: none; left: ${t.lastItem.animationOffset+t.lastItem.offsetWidth}px;`;break;case TEGMarquee.D_RIGHT:e.style=`transition: none; right: ${t.lastItem.animationOffset+t.lastItem.offsetWidth}px;`}t.lastItem=e}pause(){var t=this;for(let e=0;e<t.marqueeContents.length;e++){var n=t.marqueeContents[e];n.ontransitionend=null,n.style=`transition: none; ${t.direction}: ${n.animationOffset}px;`}t.isRunning=!1}play(){let n=this;n.isRunning=!0;for(let t=0;t<n.marqueeContents.length;t++){let e=n.marqueeContents[t];null===e.ontransitionend&&(e.ontransitionend=()=>{TEGMarquee.scrollItem(n,e)}),0<this.delay?setTimeout(TEGMarquee.scrollItem,n.delay,n,e):TEGMarquee.scrollItem(n,e)}}static scrollItem(e,t){t.style=`transition: ${e.direction} ${e.duration}s ${e.timing} 0s; `+`${e.direction}: ${t.animationOffset-e.scrollDistance}px;`}static start(e){e.play()}static stop(e){e.pause()}}class TEGMElement{constructor(e,t){var n=this;(n._element=e)instanceof HTMLElement||console.error("%cTEGMElement Error%c: %cNo HTMLElement provided.","font-weight: bold;, color: red;","font-weight: normal; color: auto;","color: yellow;"),n._element.setAttribute("data-marqueeid",parseInt(Date.now()/Math.random())),n._duped=!1,n._direction,TEGMarquee.DIRECTIONS.includes(t)?n._direction=t:(n._direction=TEGMarquee.D_UP,console.error("TEGMElement Error: No scroll direction provided. Defaulted to TEGMarquee.D_UP.")),n._lastRatio=0,n._seen=!1}get element(){return this._element}set duped(e){this._duped=!!e,this.element.setAttribute("data-mqdbgDuped",e)}get duped(){return this._duped}set seen(e){this._seen=!!e,this.element.setAttribute("data-mqdbgSeen",e)}get seen(){return this._seen}get lastRatio(){return this._lastRatio}set lastRatio(e){this._lastRatio=e,this.element.setAttribute("data-mqdbgLastRatio",e)}get offsetHeight(){return this._element.offsetHeight||0}get offsetWidth(){return this._element.offsetWidth||0}get id(){return this._element.getAttribute("data-marqueeid")}get ontransitionend(){return this._element.ontransitionend}set ontransitionend(e){this._element.ontransitionend=e}get style(){return this._element.style}set style(e){this._element.style=e}get animationOffset(){switch(this._direction){case TEGMarquee.D_UP:return this._element.offsetTop;case TEGMarquee.D_DOWN:return null===this._element.offsetParent?0:this._element.offsetParent.offsetHeight-(this._element.offsetTop+this._element.offsetHeight);case TEGMarquee.D_LEFT:return this._element.offsetLeft;case TEGMarquee.D_RIGHT:return null===this._element.offsetParent?0:this._element.offsetParent.offsetWidth-(this._element.offsetLeft+this._element.offsetWidth);default:return 0}}remove(){this._element.remove()}}
//# sourceMappingURL=TEGMarquee.min.js.map